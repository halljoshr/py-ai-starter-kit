# .agents/ Directory Structure

This directory contains AI methodology artifacts used throughout the development process.

## Directory Overview

```
.agents/
├── research/              # Research documents and analysis
├── specs/                # Implementation specifications (Anthropic XML format)
├── plans/                # Feature implementation plans
├── architecture/         # Architecture Decision Records (ADRs)
├── decisions/            # Decision log (why we made choices)
├── init-context/         # Context reports from /prime command
├── progress/             # Live session progress tracking
├── execution-reports/    # Post-implementation feedback
├── analytics/            # Token usage, metrics, performance data
└── features/             # JSON feature tracking (feature_list.json style)
```

## Directory Purposes

### research/
**Purpose:** Research documents, analysis, and findings that inform the methodology.

**Current files:**
- `ANTHROPIC-HARNESS-COMPARISON.md` - Comparison of Anthropic's approach vs PIV Loop
- `CONTEXT-OPTIMIZATION-RESEARCH.md` - Prompt caching, compaction, and optimization patterns
- `PRIME-OPTIMIZATION-RECOMMENDATIONS.md` - Strategies for token-efficient context loading
- `RESEARCH-ANALYSIS.md` - General research analysis
- `SPEC-CREATION-PROCESS.md` - Process documentation for creating implementation specs
- `TAX-ANALYSIS-SESSION-COMPARISON.md` - Session breakdown comparison for multi-session work

**When to add files:**
- Completed research on new methodologies
- Comparative analyses of approaches
- Process documentation
- Pattern analysis and recommendations

---

### specs/
**Purpose:** Implementation specifications in Anthropic's XML format. These are comprehensive documents that guide entire feature implementations.

**Current files:**
- `tax_analysis_spec.txt` - Example spec for tax analysis feature (from uw-portal-api)
- `UW-PORTAL-TAX-ANALYSIS-SPEC.md` - Alternative markdown format (superseded by .txt)

**Naming convention:** `[feature-name]-spec.txt`

**When to add files:**
- Before implementing large features (2+ sessions)
- When following the spec creation process
- After completing technical discovery phase

**Template structure:**
```xml
<project_specification>
  <project_name>...</project_name>
  <overview>...</overview>
  <technology_stack>...</technology_stack>
  <core_features>...</core_features>
  <data_models>...</data_models>
  <api_endpoints>...</api_endpoints>
  <services_to_implement>...</services_to_implement>
  <workflow_nodes>...</workflow_nodes>
  <session_management>...</session_management>
  <success_criteria>...</success_criteria>
  <constraints>...</constraints>
  <gotchas>...</gotchas>
</project_specification>
```

---

### plans/
**Purpose:** Feature implementation plans created by `/plan-feature` command. These are more tactical than specs.

**Naming convention:** `[feature-name]-plan.md`

**When to add files:**
- Output from `/plan-feature` command
- Before starting implementation
- One plan per feature/task

**Typical structure:**
- Feature overview
- Implementation phases
- Task breakdown with TDD approach
- Validation criteria
- Token estimates

---

### architecture/
**Purpose:** Architecture Decision Records (ADRs) documenting major architectural choices.

**Subdirectories:**
- `adr/` - Individual ADR documents

**Naming convention:** `adr/NNN-title-of-decision.md`

**When to add files:**
- Major architectural decisions
- Technology choices
- Pattern selections
- Design trade-offs

**Template structure:**
```markdown
# ADR NNN: [Title]

## Status
[Proposed | Accepted | Deprecated | Superseded]

## Context
What is the issue that we're seeing that is motivating this decision?

## Decision
What is the change that we're proposing/doing?

## Consequences
What becomes easier or more difficult to do because of this change?

## Date
YYYY-MM-DD
```

---

### decisions/
**Purpose:** Decision log tracking all significant choices made during development.

**File:** `DECISIONS.md` (single append-only log)

**When to add entries:**
- Technology selections
- Process changes
- Pattern adoptions
- Significant trade-offs

**Entry format:**
```markdown
### YYYY-MM-DD: [Decision Title]
**Context:** Why this decision was needed
**Decision:** What was chosen
**Rationale:** Why this choice was made
**Alternatives considered:** What else was evaluated
**Status:** [Adopted | Deprecated | Under Review]
**Owner:** @username
```

---

### init-context/
**Purpose:** Context reports generated by `/prime` command. Snapshots of codebase understanding.

**Naming convention:** `[project-name]-context-YYYY-MM-DD.md`

**When to add files:**
- Output from `/prime --full` command
- Before starting work on unfamiliar codebase
- Periodically (weekly/monthly) for large codebases

---

### progress/
**Purpose:** Live session progress tracking that survives conversation boundaries.

**Files:**
- `current-session.txt` - Live progress, updated during work
- `[feature-name]-history.txt` - Complete session history per feature
- `session-metrics.json` - Token usage, tasks completed, time spent

**When to update:**
- During `/implement-plan` execution
- At checkpoint boundaries
- When sessions pause/resume

---

### execution-reports/
**Purpose:** Post-implementation feedback documenting what worked, what didn't, and lessons learned.

**Naming convention:** `[feature-name]-execution-report.md`

**When to add files:**
- After completing feature implementation
- Generated by `/execution-report` command
- Before creating PR

**Typical structure:**
- What worked well
- What was difficult
- What changed from plan
- Recommendations for future
- Patterns to reuse
- Anti-patterns to avoid

---

### analytics/
**Purpose:** Token usage metrics, performance data, and optimization tracking.

**Files:**
- `token-history.json` - Historical token usage per feature
- `session-metrics.json` - Aggregated session statistics
- `optimization-impact.json` - Before/after optimization comparisons

**When to add files:**
- Automatic tracking by commands
- Post-feature analysis
- Optimization experiments

---

### features/
**Purpose:** JSON-based feature tracking inspired by Anthropic's feature_list.json.

**File:** `project-features.json` (single source of truth)

**When to update:**
- Adding new features
- Updating feature status
- Recording test results
- Tracking progress

**Structure:**
```json
{
  "project": "project-name",
  "version": "1.0.0",
  "features": [
    {
      "id": "feat-001",
      "name": "Feature Name",
      "status": "in_progress",
      "test_steps": ["..."],
      "passes": false
    }
  ]
}
```

---

## Workflow Integration

### Feature Development Flow:

1. **Research Phase** → `research/`
   - Analyze patterns, research APIs, design models

2. **Spec Creation** → `specs/`
   - Create comprehensive implementation spec

3. **Planning** → `plans/`
   - Generate tactical implementation plan

4. **Implementation** → `progress/`
   - Track live progress across sessions

5. **Review** → `execution-reports/`
   - Document learnings and feedback

6. **Decision Log** → `decisions/`
   - Record key choices made

7. **Metrics** → `analytics/`
   - Track token usage and performance

## Maintenance

- Keep directories organized by purpose
- Use consistent naming conventions
- Archive old files (> 3 months) to `archive/` subdirectories
- Update this README when adding new patterns

## See Also

- [GOALS.md](../GOALS.md) - Complete goals and roadmap
- [CLAUDE.md](../CLAUDE.md) - Main instructions for AI
- [.claude/reference/](../.claude/reference/) - Best practices and patterns
